2024-01-08 20:39:21,082 - gdn - INFO - Namespace(accelerator='ddp', add_scl=False, anomaly_alpha=0.1, batch_size=512, bipartite=True, ckpt_file='./', data_set='zhuanzhang', dev_alpha=1.0, dev_beta=1.0, dir_data='./dataset', drop_out=0.2, edge_dim=17, gpus=1, hidden_dim=16, input_dim=17, learning_rate=0.0001, mask_label=False, mask_ratio=0.01, memory_size=5000, mode='sad', model_type='all', module_type='graph_attention', n_epochs=30, n_heads=2, n_layer=2, n_neighbors=20, num_data_workers=1, range=[], sample_size=2000, supc_alpha=0.001, train_ratio=0.7, type_num=0)
2024-01-08 20:44:07,064 - gdn - INFO - 
 epoch: 0
2024-01-08 20:44:07,064 - gdn - INFO - train mean loss:73.37395798057274, class loss: 73.14811415527106, anomaly loss: 0.8256916409082539, sup loss: 2.441347122192383
2024-01-08 20:44:07,064 - gdn - INFO - test mean loss:116.08003316682168, test auc:0.9305606000929599, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 1
train mean loss:68.57524467929048, class loss: 68.39343469676973, anomaly loss: 0.7696482624751504, sup loss: 2.4517643451690674
test mean loss:115.97043768147859, test auc:0.9340107742271982, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 2
train mean loss:67.77018080452247, class loss: 67.58777101732557, anomaly loss: 0.7340394057235334, sup loss: 2.463467836380005
test mean loss:115.71624574835033, test auc:0.9515059608409209, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 3
train mean loss:67.16808989128745, class loss: 66.98465129748018, anomaly loss: 0.7262624395853536, sup loss: 2.4707322120666504
test mean loss:115.18857492916908, test auc:0.9601545745101184, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 4
train mean loss:66.88653086259428, class loss: 66.69920808679937, anomaly loss: 0.7279720877925149, sup loss: 2.474687337875366
test mean loss:115.09871354665631, test auc:0.9637999997743874, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 5
train mean loss:66.54707024489974, class loss: 66.36024655346942, anomaly loss: 0.7362915059818103, sup loss: 2.4666941165924072
test mean loss:116.37450151583873, test auc:0.9660051749841418, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 6
train mean loss:66.46995987267174, class loss: 66.29333067063116, anomaly loss: 0.7463726319055096, sup loss: 2.464031457901001
test mean loss:115.5223467662607, test auc:0.969521214939166, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 7
train mean loss:66.35034757912454, class loss: 66.1739879659399, anomaly loss: 0.7603549569891304, sup loss: 2.463904857635498
test mean loss:115.28953104830187, test auc:0.9755295118438643, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 8
train mean loss:66.19503578271518, class loss: 66.02242469728667, anomaly loss: 0.7444163771758884, sup loss: 2.474233865737915
test mean loss:116.027379609884, test auc:0.9647149266392681, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 9
train mean loss:66.34436353568269, class loss: 66.17355270946743, anomaly loss: 0.7701534441173764, sup loss: 2.4752848148345947
test mean loss:115.70183853730603, test auc:0.9700654629296532, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 10
train mean loss:66.16754105671976, class loss: 65.99614107969211, anomaly loss: 0.764456401402466, sup loss: 2.4883360862731934
test mean loss:115.46107491827107, test auc:0.9699580322331581, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 11
train mean loss:65.79459381023275, class loss: 65.6225076100308, anomaly loss: 0.7686674183232406, sup loss: 2.492710590362549
test mean loss:116.59969351377757, test auc:0.9676942344008913, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 12
train mean loss:65.78563604401262, class loss: 65.61475401524088, anomaly loss: 0.7688802270822924, sup loss: 2.4944450855255127
test mean loss:115.37485204008208, test auc:0.9708923131181144, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 13
train mean loss:65.44312504796302, class loss: 65.27076141762488, anomaly loss: 0.769503935591848, sup loss: 2.5001933574676514
test mean loss:115.21801880223181, test auc:0.9717870993914364, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 14
train mean loss:65.23588613625314, class loss: 65.06257835987655, anomaly loss: 0.7738641585684675, sup loss: 2.5092644691467285
test mean loss:114.46004759877135, test auc:0.9726110892748998, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 15
train mean loss:65.29892100740301, class loss: 65.12839449453368, anomaly loss: 0.7844716370800496, sup loss: 2.5188307762145996
test mean loss:115.05579798505629, test auc:0.9724066480954381, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 16
train mean loss:65.00951448034101, class loss: 64.83765926394022, anomaly loss: 0.775357361988572, sup loss: 2.5186939239501953
test mean loss:114.22974974880803, test auc:0.9718735954903759, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 17
train mean loss:64.93833463607541, class loss: 64.76730682394806, anomaly loss: 0.7746985454557039, sup loss: 2.528930425643921
test mean loss:114.60045828598322, test auc:0.9737353695498494, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 18
train mean loss:64.8372662839016, class loss: 64.66649355880078, anomaly loss: 0.7666769319433909, sup loss: 2.549203395843506
test mean loss:113.28995578441695, test auc:0.9727473019453201, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 19
train mean loss:64.41469887526243, class loss: 64.24380328711776, anomaly loss: 0.7610869269990359, sup loss: 2.5670015811920166
test mean loss:112.63366482504134, test auc:0.9740617699512608, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 20
train mean loss:64.387026586436, class loss: 64.2168432734483, anomaly loss: 0.751527252010732, sup loss: 2.6327731609344482
test mean loss:113.11885436977823, test auc:0.973038163391688, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 21
train mean loss:64.33459329302136, class loss: 64.16806218634308, anomaly loss: 0.7443163677751673, sup loss: 2.639281988143921
test mean loss:113.29335419050096, test auc:0.972718510554345, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 22
train mean loss:64.04691262744771, class loss: 63.88377139627621, anomaly loss: 0.7017191390408798, sup loss: 2.663116455078125
test mean loss:113.9872055307015, test auc:0.9710970561388073, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 23
train mean loss:64.09321608000914, class loss: 63.942898462245275, anomaly loss: 0.5803563382722416, sup loss: 2.8199269771575928
test mean loss:112.70883629567265, test auc:0.9706361346665178, test pr_auc:0.05202817551639958, test gmean:0.027956104344805534

 epoch: 24
train mean loss:63.97110165686986, class loss: 63.82610694036893, anomaly loss: 0.5256068608314457, sup loss: 2.879258632659912
test mean loss:112.82296709975712, test auc:0.9710261834212813, test pr_auc:0.05202853945159485, test gmean:0.028087663209546566

 epoch: 25
train mean loss:63.555045846992776, class loss: 63.405827294116506, anomaly loss: 0.5997772535085105, sup loss: 2.8277063369750977
test mean loss:112.05481265091392, test auc:0.9713095588086151, test pr_auc:0.05202853945159485, test gmean:0.028087663209546566

 epoch: 26
train mean loss:63.44129231289343, class loss: 63.28594455574707, anomaly loss: 0.648697819556295, sup loss: 2.82366943359375
test mean loss:113.68281415315016, test auc:0.9713703934465849, test pr_auc:0.052029631287729874, test gmean:0.02847869357745714

 epoch: 27
train mean loss:63.55444567645996, class loss: 63.40310056534859, anomaly loss: 0.6180551108625049, sup loss: 2.8069047927856445
test mean loss:111.9341760907088, test auc:0.9722452477903483, test pr_auc:0.05198962723758798, test gmean:0.0

 epoch: 28
train mean loss:63.5937775171628, class loss: 63.43586892196549, anomaly loss: 0.6675104656920601, sup loss: 2.8064544200897217
test mean loss:112.96551886793901, test auc:0.9717785115375643, test pr_auc:0.05203145111645867, test gmean:0.02911874413595138

 epoch: 29
train mean loss:63.311944319839746, class loss: 63.16076796279419, anomaly loss: 0.6278324827680744, sup loss: 2.7998976707458496
test mean loss:112.82687182526627, test auc:0.969832026653558, test pr_auc:0.052024172565257536, test gmean:0.02646583025997456

 max_test_auc: 0.9755295118438643

 best auc: epoch=7,  test=0.9755295118438643